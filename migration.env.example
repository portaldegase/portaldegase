#!/bin/bash
# Arquivo: migration.env.example
# 
# Configuração para migração automatizada do CMS DEGASE
# 
# INSTRUÇÕES:
# 1. Copie este arquivo: cp migration.env.example migration.env
# 2. Edite migration.env com seus dados reais
# 3. Proteja o arquivo: chmod 600 migration.env
# 4. Execute o script: bash migrate.sh
#
# AVISO: Este arquivo contém dados sensíveis (senhas, chaves API)
#        Nunca compartilhe ou commite no repositório!

# ===== ACESSO AO SERVIDOR =====
# Usuário SSH para conectar ao servidor
SSH_USER="root"

# IP ou domínio do servidor RedHat/CentOS
SSH_HOST="192.168.1.100"

# Porta SSH (padrão: 22)
SSH_PORT="22"

# Caminho da chave privada SSH
SSH_KEY_PATH="$HOME/.ssh/id_rsa"

# ===== GITHUB =====
# URL do repositório GitHub
GITHUB_REPO="https://github.com/portaldegase/portaldegase.git"

# Branch a clonar (main, develop, etc)
GITHUB_BRANCH="main"

# Token pessoal GitHub (se repositório privado)
# Gere em: https://github.com/settings/tokens
GITHUB_TOKEN=""

# ===== DIRETÓRIOS =====
# Diretório onde a aplicação será instalada
APP_DIR="/var/www/portaldegase"

# Usuário que executará a aplicação
APP_USER="portaldegase"

# Grupo do usuário
APP_GROUP="portaldegase"

# Porta da aplicação Node.js
APP_PORT="3000"

# Diretório de logs
LOG_DIR="/var/log/portaldegase"

# Diretório de backups
BACKUP_DIR="/var/backups/portaldegase"

# ===== BANCO DE DADOS =====
# Host do banco de dados MySQL
DB_HOST="localhost"

# Porta MySQL (padrão: 3306)
DB_PORT="3306"

# Nome do banco de dados
DB_NAME="portaldegase"

# Usuário do banco de dados
DB_USER="portaldegase_user"

# Senha do usuário do banco (MUDE ISTO!)
# Gere uma senha segura: openssl rand -base64 32
DB_PASSWORD="senha_super_segura_aqui_123"

# Senha root do MySQL (para setup inicial)
DB_ROOT_PASSWORD="senha_root_mysql_123"

# ===== DOMÍNIO =====
# Nome do domínio principal
DOMAIN_NAME="portaldegase.com.br"

# Alias do domínio (www)
DOMAIN_ALIAS="www.portaldegase.com.br"

# IP do servidor (para configuração de DNS)
DOMAIN_IP="seu-ip-servidor-aqui"

# ===== PROXY REVERSO =====
# Usar Nginx? (true/false)
NGINX_ENABLED="true"

# Usar Apache? (true/false) - escolha um ou outro
APACHE_ENABLED="false"

# ===== SISTEMA OPERACIONAL =====
# Versão do RedHat/CentOS (7, 8, 9)
OS_VERSION="8"

# SELinux habilitado? (true/false)
SELINUX_ENABLED="true"

# Tipo de firewall (firewalld, ufw, none)
FIREWALL_TYPE="firewalld"

# ===== NODE.JS =====
# Versão do Node.js a instalar
NODE_VERSION="18.0.0"

# Usar pnpm em vez de npm? (true/false)
PNPM_ENABLED="true"

# ===== PM2 (Gerenciador de Processos) =====
# Usar PM2? (true/false)
PM2_ENABLED="true"

# Nome da aplicação no PM2
PM2_APP_NAME="portaldegase"

# Número de instâncias (max, 1, 2, 4, etc)
PM2_INSTANCES="max"

# Monitorar mudanças de arquivo? (true/false)
PM2_WATCH="false"

# ===== FIREWALL =====
# Firewall habilitado? (true/false)
FIREWALL_ENABLED="true"

# Abrir porta 80 (HTTP)? (true/false)
FIREWALL_HTTP_ENABLED="true"

# Abrir porta 443 (HTTPS)? (true/false) - ativar quando tiver SSL
FIREWALL_HTTPS_ENABLED="false"

# Abrir porta SSH? (true/false)
FIREWALL_SSH_ENABLED="true"

# ===== BACKUP =====
# Fazer backups automáticos? (true/false)
BACKUP_ENABLED="true"

# Frequência de backup (hourly, daily, weekly)
BACKUP_FREQUENCY="daily"

# Manter backups por quantos dias?
BACKUP_RETENTION_DAYS="30"

# Comprimir backups? (true/false)
BACKUP_COMPRESS="true"

# Fazer backup remoto? (true/false) - S3, etc
BACKUP_REMOTE_ENABLED="false"

# Bucket S3 para backup remoto
BACKUP_REMOTE_BUCKET="seu-bucket-s3"

# Região AWS
BACKUP_REMOTE_REGION="us-east-1"

# ===== MONITORAMENTO =====
# Monitorar saúde da aplicação? (true/false)
MONITORING_ENABLED="false"

# Ferramenta de monitoramento (prometheus, newrelic, datadog)
MONITORING_TOOL="prometheus"

# Chave API de monitoramento
MONITORING_API_KEY=""

# URL de health check
HEALTH_CHECK_URL="http://localhost:3000/health"

# Intervalo de health check (segundos)
HEALTH_CHECK_INTERVAL="60"

# ===== EMAIL / SMTP =====
# Enviar emails? (true/false)
SMTP_ENABLED="false"

# Host SMTP
SMTP_HOST="smtp.gmail.com"

# Porta SMTP
SMTP_PORT="587"

# Usuário SMTP
SMTP_USER="seu-email@gmail.com"

# Senha SMTP (use app password para Gmail)
SMTP_PASSWORD="sua-senha-app"

# Email de origem
SMTP_FROM="noreply@portaldegase.com.br"

# Email do administrador
ADMIN_EMAIL="admin@portaldegase.com.br"

# ===== SEGURANÇA =====
# Habilitar headers de segurança? (true/false)
SECURITY_HEADERS_ENABLED="true"

# Habilitar CORS? (true/false)
CORS_ENABLED="true"

# Origens CORS permitidas
CORS_ORIGINS="https://portaldegase.com.br,https://www.portaldegase.com.br"

# Rate limiting habilitado? (true/false)
RATE_LIMIT_ENABLED="true"

# Requisições por minuto (rate limit)
RATE_LIMIT_REQUESTS="100"

# Janela de rate limit (segundos)
RATE_LIMIT_WINDOW="60"

# ===== AGENDAMENTO (CRON) =====
# Ativar cron jobs? (true/false)
CRON_ENABLED="true"

# Horário do backup (HH:MM)
CRON_BACKUP_TIME="02:00"

# Horário de limpeza de logs (HH:MM)
CRON_CLEANUP_TIME="03:00"

# Health check (formato cron)
CRON_HEALTH_CHECK="*/5 * * * *"

# ===== SSL/TLS (FUTURO) =====
# SSL habilitado? (true/false) - ativar quando tiver certificado
SSL_ENABLED="false"

# Caminho do certificado SSL
SSL_CERT_PATH="/etc/ssl/certs/portaldegase.com.br.crt"

# Caminho da chave privada SSL
SSL_KEY_PATH="/etc/ssl/private/portaldegase.com.br.key"

# Email para Let's Encrypt (quando tiver certificado)
LETSENCRYPT_EMAIL="admin@portaldegase.com.br"

# ===== API KEYS MANUS =====
# IMPORTANTE: Obtenha estas chaves no painel Manus
# https://manus.im → Configurações → API Keys

# ID da aplicação Manus
VITE_APP_ID="seu-app-id-aqui"

# Chave de API do servidor (backend)
BUILT_IN_FORGE_API_KEY="sua-chave-servidor-aqui"

# Chave de API do frontend
VITE_FRONTEND_FORGE_API_KEY="sua-chave-frontend-aqui"

# Chave secreta JWT para sessões
JWT_SECRET="sua-chave-secreta-jwt-aqui"

# URL do servidor OAuth Manus
OAUTH_SERVER_URL="https://api.manus.im"

# URL do portal OAuth Manus
VITE_OAUTH_PORTAL_URL="https://portal.manus.im"

# URL base da API Manus (backend)
BUILT_IN_FORGE_API_URL="https://api.manus.im"

# URL base da API Manus (frontend)
VITE_FRONTEND_FORGE_API_URL="https://api.manus.im"

# ===== INFORMAÇÕES DO PROPRIETÁRIO =====
# Nome do proprietário
OWNER_NAME="DEGASE"

# Open ID do proprietário (obtém no painel Manus)
OWNER_OPEN_ID=""

# ===== ANALYTICS =====
# Endpoint de analytics
VITE_ANALYTICS_ENDPOINT=""

# ID do website para analytics
VITE_ANALYTICS_WEBSITE_ID=""

# ===== TÍTULO E LOGO DA APLICAÇÃO =====
# Título da aplicação
VITE_APP_TITLE="CMS DEGASE"

# URL do logo da aplicação
VITE_APP_LOGO=""

# ===== VARIÁVEIS CUSTOMIZADAS =====
# Adicione aqui qualquer outra variável necessária
# CUSTOM_VAR="valor"

################################################################################
# INSTRUÇÕES DE USO
################################################################################
#
# 1. COPIAR ARQUIVO:
#    cp migration.env.example migration.env
#
# 2. EDITAR ARQUIVO:
#    nano migration.env
#    (ou seu editor preferido)
#
# 3. PREENCHER DADOS:
#    - Substitua "seu-usuario" pelo seu usuário SSH
#    - Substitua "192.168.1.100" pelo IP do seu servidor
#    - Substitua as senhas por senhas seguras
#    - Obtenha as API Keys no painel Manus
#
# 4. PROTEGER ARQUIVO:
#    chmod 600 migration.env
#
# 5. VALIDAR CONECTIVIDADE:
#    source migration.env
#    ssh -i $SSH_KEY_PATH -p $SSH_PORT $SSH_USER@$SSH_HOST "echo OK"
#
# 6. EXECUTAR MIGRAÇÃO:
#    bash migrate.sh
#
################################################################################
# SEGURANÇA
################################################################################
#
# ⚠️  IMPORTANTE:
#
# - Nunca compartilhe este arquivo
# - Nunca commite no repositório público
# - Nunca envie por email ou chat
# - Proteja com chmod 600
# - Use um gerenciador de senhas
# - Mude as senhas padrão após a migração
# - Revise as permissões de arquivo após a migração
#
################################################################################
